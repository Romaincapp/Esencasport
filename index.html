<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tournoi Unihoc - Planning & Classement</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        .subtitle {
            font-size: 1.2em;
            opacity: 0.95;
        }
        
        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
        }
        
        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            background: #f8f9fa;
            border: none;
            font-size: 1.1em;
            font-weight: 600;
            color: #6c757d;
            transition: all 0.3s ease;
        }
        
        .tab:hover {
            background: #e9ecef;
        }
        
        .tab.active {
            background: white;
            color: #667eea;
            border-bottom: 3px solid #667eea;
            margin-bottom: -2px;
        }
        
        .tab-content {
            display: none;
            padding: 30px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .controls {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 2px solid #e9ecef;
        }
        
        .control-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #495057;
        }
        
        select, button, input[type="number"] {
            padding: 10px 20px;
            border-radius: 8px;
            border: 2px solid #dee2e6;
            font-size: 1em;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        input[type="number"] {
            width: 60px;
            text-align: center;
        }
        
        select:hover, button:hover {
            border-color: #667eea;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            font-weight: 600;
            margin-right: 10px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .info-box {
            background: #d4edda;
            border-left: 4px solid #28a745;
            color: #155724;
            padding: 15px 20px;
            margin-bottom: 25px;
            border-radius: 8px;
        }
        
        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            color: #856404;
            padding: 15px 20px;
            margin-bottom: 25px;
            border-radius: 8px;
        }
        
        .teams-section {
            margin-bottom: 40px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
            border: 2px solid #e9ecef;
        }
        
        .teams-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 12px;
            margin-top: 20px;
        }
        
        .team-item {
            padding: 10px 15px;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #667eea;
            font-size: 0.95em;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.08);
        }
        
        .team-item:hover {
            transform: translateX(3px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .day-section {
            margin-bottom: 40px;
            page-break-inside: avoid;
        }
        
        .day-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px 15px 0 0;
            font-size: 1.5em;
            font-weight: bold;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .day-content {
            background: white;
            border: 2px solid #e9ecef;
            border-top: none;
            border-radius: 0 0 15px 15px;
            padding: 25px;
        }
        
        .matches-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .match {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }
        
        .match.official {
            background: #e7f3ff;
            border-color: #0066cc;
        }
        
        .match.played {
            background: #d4edda;
            border-color: #28a745;
        }
        
        .match:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .match-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .match-number {
            font-size: 0.85em;
            font-weight: 600;
            color: #6c757d;
        }
        
        .match-type {
            font-size: 0.75em;
            padding: 3px 8px;
            border-radius: 12px;
            font-weight: 600;
        }
        
        .match-type.official {
            background: #0066cc;
            color: white;
        }
        
        .match-type.friendly {
            background: #28a745;
            color: white;
        }
        
        .match-teams {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .team-name {
            font-weight: 600;
            color: #2c3e50;
            flex: 1;
        }
        
        .vs {
            color: #667eea;
            font-weight: bold;
            font-size: 0.9em;
        }
        
        .score-input {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
        }
        
        .score-display {
            font-size: 1.3em;
            font-weight: bold;
            color: #28a745;
            text-align: center;
            margin-top: 10px;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
        }
        
        .stat-card {
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
            display: block;
        }
        
        .stat-label {
            color: #6c757d;
            margin-top: 5px;
            font-size: 0.9em;
        }
        
        .ranking-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        
        .ranking-table thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .ranking-table th,
        .ranking-table td {
            padding: 12px 15px;
            text-align: left;
        }
        
        .ranking-table th {
            font-weight: 600;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .ranking-table tbody tr {
            border-bottom: 1px solid #e9ecef;
            transition: all 0.3s ease;
        }
        
        .ranking-table tbody tr:hover {
            background: #f8f9fa;
            transform: translateX(5px);
        }
        
        .ranking-table .rank-1 {
            background: linear-gradient(90deg, #ffd700 0%, #ffed4e 100%);
            font-weight: bold;
        }
        
        .ranking-table .rank-2 {
            background: linear-gradient(90deg, #c0c0c0 0%, #d8d8d8 100%);
        }
        
        .ranking-table .rank-3 {
            background: linear-gradient(90deg, #cd7f32 0%, #e5a15d 100%);
        }
        
        .position {
            font-weight: bold;
            font-size: 1.2em;
            color: #667eea;
        }
        
        .save-button {
            background: #28a745;
            color: white;
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            margin-left: 10px;
        }
        
        .save-button:hover {
            background: #218838;
        }
        
        .edit-notice {
            background: #d1ecf1;
            border-left: 4px solid #0c5460;
            color: #0c5460;
            padding: 15px 20px;
            margin-bottom: 25px;
            border-radius: 8px;
            font-size: 0.95em;
        }
        
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        
        @media print {
            body {
                background: white;
            }
            .controls, .edit-notice, .info-box, .warning-box, .tabs, .score-input {
                display: none;
            }
            .tab-content {
                display: block !important;
            }
            .day-section {
                page-break-after: always;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üèí Tournoi de Unihoc - Gestion Compl√®te</h1>
            <div class="subtitle">7 √©quipes ‚Ä¢ 4 journ√©es ‚Ä¢ 16 matchs par √©quipe</div>
        </header>
        
        <div class="tabs">
            <button class="tab active" onclick="showTab('planning')">üìÖ Planning</button>
            <button class="tab" onclick="showTab('results')">üìù R√©sultats</button>
            <button class="tab" onclick="showTab('ranking')">üèÜ Classement</button>
        </div>
        
        <!-- Onglet Planning -->
        <div id="planning" class="tab-content active">
            <div class="edit-notice">
                üí° <strong>Pour modifier les noms des √©quipes :</strong> Recherchez <code>const teams = [</code> dans le code source et remplacez les noms entre guillemets.
            </div>
            
            <div class="controls">
                <h2>‚öôÔ∏è Configuration du tournoi</h2>
                <div class="control-group">
                    <label for="officialMatches">Nombre de matchs officiels par √©quipe et par journ√©e :</label>
                    <select id="officialMatches">
                        <option value="3">3 matchs officiels + 1 amical (Recommand√©)</option>
                        <option value="2">2 matchs officiels + 2 amicaux</option>
                        <option value="4">4 matchs officiels (Tous comptent)</option>
                    </select>
                </div>
                <button onclick="regenerateSchedule()">üîÑ R√©g√©n√©rer le planning</button>
                <button onclick="window.print()">üñ®Ô∏è Imprimer</button>
                <button onclick="saveData()">üíæ Sauvegarder</button>
                <button onclick="loadData()">üìÇ Charger</button>
            </div>
            
            <div class="teams-section">
                <h2>üìã √âquipes participantes</h2>
                <div class="teams-grid" id="teamsList"></div>
            </div>
            
            <div class="stats">
                <div class="stat-card">
                    <span class="stat-number">7</span>
                    <span class="stat-label">√âquipes</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">4</span>
                    <span class="stat-label">Journ√©es</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">14</span>
                    <span class="stat-label">Matchs/journ√©e</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">56</span>
                    <span class="stat-label">Matchs totaux</span>
                </div>
            </div>
            
            <div id="schedule"></div>
        </div>
        
        <!-- Onglet R√©sultats -->
        <div id="results" class="tab-content">
            <div class="info-box">
                ‚úÖ <strong>Saisie des scores :</strong> Entrez les scores de chaque match et cliquez sur "Enregistrer". Les statistiques et le classement se mettront √† jour automatiquement.
            </div>
            
            <div id="resultsContent"></div>
        </div>
        
        <!-- Onglet Classement -->
        <div id="ranking" class="tab-content">
            <div class="info-box">
                üèÜ <strong>Classement officiel :</strong> Bas√© uniquement sur les matchs officiels. Victoire = 3 pts, Nul = 1 pt, D√©faite = 0 pt.
            </div>
            
            <h2>üèÜ Classement G√©n√©ral</h2>
            <table class="ranking-table" id="rankingTable">
                <thead>
                    <tr>
                        <th>Pos.</th>
                        <th>√âquipe</th>
                        <th>J</th>
                        <th>V</th>
                        <th>N</th>
                        <th>D</th>
                        <th>BP</th>
                        <th>BC</th>
                        <th>Diff</th>
                        <th>Pts</th>
                    </tr>
                </thead>
                <tbody id="rankingBody">
                    <!-- Le classement sera g√©n√©r√© ici -->
                </tbody>
            </table>
        </div>
    </div>
    
    <script>
        // ‚ö†Ô∏è MODIFIEZ ICI LES NOMS DES √âQUIPES ‚ö†Ô∏è
        const teams = [
            "√âquipe Rouge",
            "√âquipe Bleue", 
            "√âquipe Verte",
            "√âquipe Jaune",
            "√âquipe Orange",
            "√âquipe Violette",
            "√âquipe Noire"
        ];
        
        let globalMatchCounter = 1;
        let teamMatchCount = {};
        let teamOpponents = {};
        let schedule = [];
        let matchResults = {};
        
        // Initialiser les compteurs
        function initializeCounters() {
            globalMatchCounter = 1;
            teamMatchCount = {};
            teamOpponents = {};
            matchResults = {};
            teams.forEach(team => {
                teamMatchCount[team] = { official: 0, friendly: 0, total: 0, dayMatches: 0 };
                teamOpponents[team] = {};
                teams.forEach(otherTeam => {
                    if (team !== otherTeam) {
                        teamOpponents[team][otherTeam] = 0;
                    }
                });
            });
        }
        
        // G√©n√©rer les matchs pour une journ√©e
        function generateDayMatches(dayNumber, officialPerDay) {
            const matches = [];
            const dayMatchCount = {};
            
            // Initialiser le compteur de matchs du jour
            teams.forEach(team => {
                dayMatchCount[team] = 0;
            });
            
            // G√©n√©rer 14 matchs (7 √©quipes √ó 4 matchs √∑ 2)
            let attempts = 0;
            while (matches.length < 14 && attempts < 1000) {
                attempts++;
                
                // Trouver les √©quipes qui ont jou√© le moins ce jour
                const teamsByMatches = teams.filter(t => dayMatchCount[t] < 4)
                    .sort((a, b) => dayMatchCount[a] - dayMatchCount[b]);
                
                if (teamsByMatches.length < 2) break;
                
                const team1 = teamsByMatches[0];
                
                // Trouver le meilleur adversaire pour team1
                const possibleOpponents = teamsByMatches.slice(1).filter(t => {
                    // V√©rifier qu'ils ne jouent pas d√©j√† ensemble dans ce tour
                    const alreadyPlaying = matches.some(m => 
                        (m.team1 === team1 && m.team2 === t) || 
                        (m.team1 === t && m.team2 === team1)
                    );
                    return !alreadyPlaying;
                });
                
                if (possibleOpponents.length === 0) continue;
                
                // Pr√©f√©rer les √©quipes qui ont le moins jou√© contre team1
                possibleOpponents.sort((a, b) => {
                    const scoreA = teamOpponents[team1][a] * 10 + dayMatchCount[a];
                    const scoreB = teamOpponents[team1][b] * 10 + dayMatchCount[b];
                    return scoreA - scoreB;
                });
                
                const team2 = possibleOpponents[0];
                
                // D√©terminer si c'est un match officiel
                const team1DayOfficials = matches.filter(m => 
                    m.isOfficial && (m.team1 === team1 || m.team2 === team1)
                ).length;
                const team2DayOfficials = matches.filter(m => 
                    m.isOfficial && (m.team1 === team2 || m.team2 === team2)
                ).length;
                
                let isOfficial = false;
                if (team1DayOfficials < officialPerDay && team2DayOfficials < officialPerDay) {
                    // Pr√©f√©rer officiel pour les premi√®res rencontres
                    isOfficial = teamOpponents[team1][team2] === 0 || 
                                (team1DayOfficials + team2DayOfficials < officialPerDay * 2 - 2);
                }
                
                const matchId = `match_${globalMatchCounter}`;
                matches.push({
                    id: matchId,
                    team1: team1,
                    team2: team2,
                    isOfficial: isOfficial,
                    matchNumber: globalMatchCounter++
                });
                
                // Initialiser les r√©sultats
                matchResults[matchId] = { score1: null, score2: null };
                
                // Mettre √† jour les compteurs
                dayMatchCount[team1]++;
                dayMatchCount[team2]++;
                teamOpponents[team1][team2]++;
                teamOpponents[team2][team1]++;
                
                if (isOfficial) {
                    teamMatchCount[team1].official++;
                    teamMatchCount[team2].official++;
                } else {
                    teamMatchCount[team1].friendly++;
                    teamMatchCount[team2].friendly++;
                }
                teamMatchCount[team1].total++;
                teamMatchCount[team2].total++;
            }
            
            return matches.slice(0, 14);
        }
        
        // G√©n√©rer le planning complet
        function generateFullSchedule() {
            initializeCounters();
            const officialPerDay = parseInt(document.getElementById('officialMatches').value);
            schedule = [];
            
            for (let day = 1; day <= 4; day++) {
                const dayMatches = generateDayMatches(day, officialPerDay);
                schedule.push({
                    day: day,
                    matches: dayMatches
                });
            }
            
            return schedule;
        }
        
        // Afficher un onglet
        function showTab(tabName) {
            // Masquer tous les onglets
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Afficher l'onglet s√©lectionn√©
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            // Mettre √† jour le contenu si n√©cessaire
            if (tabName === 'results') {
                displayResults();
            } else if (tabName === 'ranking') {
                updateRanking();
            }
        }
        
        // Afficher la liste des √©quipes
        function displayTeams() {
            const teamsList = document.getElementById('teamsList');
            teamsList.innerHTML = '';
            teams.forEach((team, index) => {
                const teamDiv = document.createElement('div');
                teamDiv.className = 'team-item';
                teamDiv.textContent = `${index + 1}. ${team}`;
                teamsList.appendChild(teamDiv);
            });
        }
        
        // Afficher le planning
        function displaySchedule() {
            const scheduleDiv = document.getElementById('schedule');
            scheduleDiv.innerHTML = '';
            
            schedule.forEach(day => {
                const daySection = document.createElement('div');
                daySection.className = 'day-section';
                
                const dayHeader = document.createElement('div');
                dayHeader.className = 'day-header';
                dayHeader.textContent = `üìÖ Journ√©e ${day.day}`;
                daySection.appendChild(dayHeader);
                
                const dayContent = document.createElement('div');
                dayContent.className = 'day-content';
                
                // Statistiques de la journ√©e
                const officialCount = day.matches.filter(m => m.isOfficial).length;
                const friendlyCount = day.matches.filter(m => !m.isOfficial).length;
                
                const dayStats = document.createElement('div');
                dayStats.innerHTML = `
                    <p><strong>üìä R√©sum√© :</strong> ${day.matches.length} matchs ‚Ä¢ 
                    ${officialCount} officiels ‚Ä¢ ${friendlyCount} amicaux</p>
                `;
                dayContent.appendChild(dayStats);
                
                // Matchs
                const matchesContainer = document.createElement('div');
                matchesContainer.className = 'matches-container';
                
                day.matches.forEach(match => {
                    const matchDiv = document.createElement('div');
                    const result = matchResults[match.id];
                    const isPlayed = result && result.score1 !== null && result.score2 !== null;
                    
                    matchDiv.className = `match ${match.isOfficial ? 'official' : ''} ${isPlayed ? 'played' : ''}`;
                    
                    matchDiv.innerHTML = `
                        <div class="match-header">
                            <span class="match-number">Match ${match.matchNumber}</span>
                            <span class="match-type ${match.isOfficial ? 'official' : 'friendly'}">
                                ${match.isOfficial ? 'OFFICIEL' : 'AMICAL'}
                            </span>
                        </div>
                        <div class="match-teams">
                            <span class="team-name">${match.team1}</span>
                            <span class="vs">VS</span>
                            <span class="team-name">${match.team2}</span>
                        </div>
                        ${isPlayed ? `
                            <div class="score-display">
                                ${result.score1} - ${result.score2}
                            </div>
                        ` : ''}
                    `;
                    
                    matchesContainer.appendChild(matchDiv);
                });
                
                dayContent.appendChild(matchesContainer);
                daySection.appendChild(dayContent);
                scheduleDiv.appendChild(daySection);
            });
        }
        
        // Afficher les r√©sultats pour saisie
        function displayResults() {
            const resultsDiv = document.getElementById('resultsContent');
            resultsDiv.innerHTML = '';
            
            schedule.forEach(day => {
                const daySection = document.createElement('div');
                daySection.className = 'day-section';
                
                const dayHeader = document.createElement('div');
                dayHeader.className = 'day-header';
                dayHeader.textContent = `üìÖ Journ√©e ${day.day}`;
                daySection.appendChild(dayHeader);
                
                const dayContent = document.createElement('div');
                dayContent.className = 'day-content';
                
                const matchesContainer = document.createElement('div');
                matchesContainer.className = 'matches-container';
                
                day.matches.forEach(match => {
                    const matchDiv = document.createElement('div');
                    const result = matchResults[match.id] || { score1: null, score2: null };
                    
                    matchDiv.className = `match ${match.isOfficial ? 'official' : ''}`;
                    
                    matchDiv.innerHTML = `
                        <div class="match-header">
                            <span class="match-number">Match ${match.matchNumber}</span>
                            <span class="match-type ${match.isOfficial ? 'official' : 'friendly'}">
                                ${match.isOfficial ? 'OFFICIEL' : 'AMICAL'}
                            </span>
                        </div>
                        <div class="match-teams">
                            <span class="team-name">${match.team1}</span>
                            <span class="vs">VS</span>
                            <span class="team-name">${match.team2}</span>
                        </div>
                        <div class="score-input">
                            <input type="number" min="0" id="${match.id}_score1" 
                                   value="${result.score1 !== null ? result.score1 : ''}" 
                                   placeholder="0">
                            <span>-</span>
                            <input type="number" min="0" id="${match.id}_score2" 
                                   value="${result.score2 !== null ? result.score2 : ''}" 
                                   placeholder="0">
                            <button class="save-button" onclick="saveScore('${match.id}')">
                                Enregistrer
                            </button>
                        </div>
                    `;
                    
                    matchesContainer.appendChild(matchDiv);
                });
                
                dayContent.appendChild(matchesContainer);
                daySection.appendChild(dayContent);
                resultsDiv.appendChild(daySection);
            });
        }
        
        // Sauvegarder un score
        function saveScore(matchId) {
            const score1 = document.getElementById(`${matchId}_score1`).value;
            const score2 = document.getElementById(`${matchId}_score2`).value;
            
            if (score1 !== '' && score2 !== '') {
                matchResults[matchId] = {
                    score1: parseInt(score1),
                    score2: parseInt(score2)
                };
                
                // Rafra√Æchir l'affichage
                displaySchedule();
                updateRanking();
                alert('Score enregistr√© !');
            } else {
                alert('Veuillez entrer les deux scores');
            }
        }
        
        // Calculer et afficher le classement
        function updateRanking() {
            const rankings = {};
            
            // Initialiser le classement
            teams.forEach(team => {
                rankings[team] = {
                    played: 0,
                    won: 0,
                    drawn: 0,
                    lost: 0,
                    goalsFor: 0,
                    goalsAgainst: 0,
                    goalDiff: 0,
                    points: 0
                };
            });
            
            // Parcourir tous les matchs officiels jou√©s
            schedule.forEach(day => {
                day.matches.forEach(match => {
                    if (match.isOfficial && matchResults[match.id]) {
                        const result = matchResults[match.id];
                        if (result.score1 !== null && result.score2 !== null) {
                            const team1 = match.team1;
                            const team2 = match.team2;
                            const score1 = result.score1;
                            const score2 = result.score2;
                            
                            // Mettre √† jour les statistiques
                            rankings[team1].played++;
                            rankings[team2].played++;
                            rankings[team1].goalsFor += score1;
                            rankings[team1].goalsAgainst += score2;
                            rankings[team2].goalsFor += score2;
                            rankings[team2].goalsAgainst += score1;
                            
                            if (score1 > score2) {
                                // Team1 gagne
                                rankings[team1].won++;
                                rankings[team1].points += 3;
                                rankings[team2].lost++;
                            } else if (score2 > score1) {
                                // Team2 gagne
                                rankings[team2].won++;
                                rankings[team2].points += 3;
                                rankings[team1].lost++;
                            } else {
                                // Match nul
                                rankings[team1].drawn++;
                                rankings[team2].drawn++;
                                rankings[team1].points += 1;
                                rankings[team2].points += 1;
                            }
                        }
                    }
                });
            });
            
            // Calculer la diff√©rence de buts
            teams.forEach(team => {
                rankings[team].goalDiff = rankings[team].goalsFor - rankings[team].goalsAgainst;
            });
            
            // Trier le classement
            const sortedTeams = teams.sort((a, b) => {
                // D'abord par points
                if (rankings[b].points !== rankings[a].points) {
                    return rankings[b].points - rankings[a].points;
                }
                // Puis par diff√©rence de buts
                if (rankings[b].goalDiff !== rankings[a].goalDiff) {
                    return rankings[b].goalDiff - rankings[a].goalDiff;
                }
                // Puis par buts marqu√©s
                if (rankings[b].goalsFor !== rankings[a].goalsFor) {
                    return rankings[b].goalsFor - rankings[a].goalsFor;
                }
                // Enfin par ordre alphab√©tique
                return a.localeCompare(b);
            });
            
            // Afficher le classement
            const rankingBody = document.getElementById('rankingBody');
            rankingBody.innerHTML = '';
            
            sortedTeams.forEach((team, index) => {
                const rank = rankings[team];
                const row = document.createElement('tr');
                
                // Ajouter une classe sp√©ciale pour le podium
                if (index === 0) row.className = 'rank-1';
                else if (index === 1) row.className = 'rank-2';
                else if (index === 2) row.className = 'rank-3';
                
                row.innerHTML = `
                    <td class="position">${index + 1}</td>
                    <td><strong>${team}</strong></td>
                    <td>${rank.played}</td>
                    <td>${rank.won}</td>
                    <td>${rank.drawn}</td>
                    <td>${rank.lost}</td>
                    <td>${rank.goalsFor}</td>
                    <td>${rank.goalsAgainst}</td>
                    <td>${rank.goalDiff > 0 ? '+' : ''}${rank.goalDiff}</td>
                    <td><strong>${rank.points}</strong></td>
                `;
                
                rankingBody.appendChild(row);
            });
        }
        
        // Sauvegarder les donn√©es
        function saveData() {
            const data = {
                teams: teams,
                schedule: schedule,
                matchResults: matchResults
            };
            
            const dataStr = JSON.stringify(data);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = 'tournoi_unihoc.json';
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
        }
        
        // Charger les donn√©es
        function loadData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = e => {
                const file = e.target.files[0];
                const reader = new FileReader();
                
                reader.onload = readerEvent => {
                    const content = readerEvent.target.result;
                    try {
                        const data = JSON.parse(content);
                        
                        // Charger les donn√©es
                        if (data.schedule) schedule = data.schedule;
                        if (data.matchResults) matchResults = data.matchResults;
                        
                        // Rafra√Æchir l'affichage
                        displaySchedule();
                        updateRanking();
                        alert('Donn√©es charg√©es avec succ√®s !');
                    } catch (error) {
                        alert('Erreur lors du chargement du fichier');
                    }
                };
                
                reader.readAsText(file);
            };
            
            input.click();
        }
        
        // R√©g√©n√©rer le planning
        function regenerateSchedule() {
            if (Object.keys(matchResults).some(key => matchResults[key].score1 !== null)) {
                if (!confirm('Attention ! R√©g√©n√©rer le planning effacera tous les r√©sultats saisis. Continuer ?')) {
                    return;
                }
            }
            generateFullSchedule();
            displaySchedule();
            updateRanking();
        }
        
        // Initialisation
        generateFullSchedule();
        displayTeams();
        displaySchedule();
        updateRanking();
